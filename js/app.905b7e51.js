(function(t){function e(e){for(var n,a,r=e[0],c=e[1],u=e[2],d=0,l=[];d<r.length;d++)a=r[d],s[a]&&l.push(s[a][0]),s[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);p&&p(e);while(l.length)l.shift()();return o.push.apply(o,u||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],n=!0,a=1;a<i.length;a++){var r=i[a];0!==s[r]&&(n=!1)}n&&(o.splice(e--,1),t=c(c.s=i[0]))}return t}var n={},a={app:0},s={app:0},o=[];function r(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-35ef0f98":"60c0b586","chunk-4d67f7f8":"89e8acb7","chunk-63c51285":"81f458e1","chunk-85141b9a":"17dbea2d"}[t]+".js"}function c(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,c),i.l=!0,i.exports}c.e=function(t){var e=[],i={"chunk-35ef0f98":1,"chunk-4d67f7f8":1,"chunk-63c51285":1,"chunk-85141b9a":1};a[t]?e.push(a[t]):0!==a[t]&&i[t]&&e.push(a[t]=new Promise(function(e,i){for(var n="css/"+({}[t]||t)+"."+{"chunk-35ef0f98":"b95ef0dd","chunk-4d67f7f8":"7621f4ec","chunk-63c51285":"ecead84f","chunk-85141b9a":"37b70937"}[t]+".css",a=c.p+n,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var r=s[o],u=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(u===n||u===a))return e()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){r=d[o],u=r.getAttribute("data-href");if(u===n||u===a)return e()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=e,l.onerror=function(e){var n=e&&e.target&&e.target.src||a,s=new Error("Loading CSS chunk "+t+" failed.\n("+n+")");s.request=n,i(s)},l.href=a;var p=document.getElementsByTagName("head")[0];p.appendChild(l)}).then(function(){a[t]=0}));var n=s[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise(function(e,i){n=s[t]=[e,i]});e.push(n[2]=o);var u,d=document.getElementsByTagName("head")[0],l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=r(t),u=function(e){l.onerror=l.onload=null,clearTimeout(p);var i=s[t];if(0!==i){if(i){var n=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src,o=new Error("Loading chunk "+t+" failed.\n("+n+": "+a+")");o.type=n,o.request=a,i[1](o)}s[t]=void 0}};var p=setTimeout(function(){u({type:"timeout",target:l})},12e4);l.onerror=l.onload=u,d.appendChild(l)}return Promise.all(e)},c.m=t,c.c=n,c.d=function(t,e,i){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(c.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(i,n,function(e){return t[e]}.bind(null,n));return i},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/iotweb/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],d=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var p=d;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},1:function(t,e){},2:function(t,e){},3:function(t,e){},"3aff":function(t,e,i){},4:function(t,e){},"44be":function(t,e,i){"use strict";i("673e");var n=i("e7fc"),a=i.n(n),s=function(t){this.mqttParam={hostname:"",options:{username:"",password:"",clientId:""},clientId_basic:"",topic:{sub:"",pub:""}},this.Client=null,this.arrived=null,this.error=null,this.init(t)};function o(t){t=t||32;for(var e="ABCDEFGHJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz012345678",i=e.length,n="",a=0;a<t;a++)n+=e.charAt(Math.floor(Math.random()*i));return n}function r(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e}s.prototype.init=function(t){var e="";for(var i in"hostname"in t&&""!=t.hostname?this.mqttParam.hostname=t.hostname:e="'yxMqtt': 'hostnmae' must be a string.",this.mqttParam.options)if(i in t.options&&""!=t.options[i]?"clientId"==i?(this.mqttParam.options.clientId=t.options.clientId+"_"+o(32),this.mqttParam.clientId_basic=t.options.clientId):this.mqttParam.options[i]=t.options[i]:e="'yxMqtt': Lack of paramete: '".concat(i,"';"),""!=e)break;if("arrived"in t&&"function"==typeof t.arrived&&(this.arrived=t.arrived),"error"in t&&"function"==typeof t.error&&(this.error=t.error),"sub"in t.topic&&""!=t.topic.sub&&(this.mqttParam.topic.sub=t.topic.sub),"pub"in t.topic&&""!=t.topic.pub&&(this.mqttParam.topic.pub=t.topic.pub),""!=e)throw new Error(e)},s.prototype.startSub=function(){var t=this;this.Client=a.a.connect(this.mqttParam.hostname,this.mqttParam.options),this.Client.on("connect",function(){var e=t.mqttParam.topic.sub;t.Client.subscribe(e)}).on("error",function(e){t.error(e),t.Client.end(),t.Client.reconnect()}).on("message",function(e,i){var n=r(i);n=JSON.parse(n);var a={topic:e,message:n};t.arrived(a)})},s.prototype.publish=function(t){t=JSON.stringify(t),console.log(t);var e=this.mqttParam.topic.pub;this.Client.publish(e,t)},s.prototype.closeSub=function(){this.Client&&this.Client.end()},s.prototype.baudushadow_topic=function(t){var e="$baidu/iot/shadow/".concat(this.mqttParam.clientId_basic).concat(t);return e},e["a"]=s},"56d7":function(t,e,i){"use strict";i.r(e);i("aa35");var n=i("06e0"),a=i.n(n),s=(i("cadf"),i("551c"),i("097d"),i("2b0e")),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},r=[],c=i("44be"),u={name:"App",data:function(){return{}},created:function(){this.mqtt_start()},methods:{get_mqtt_options:function(){var t=this;this.$http.post("".concat(this.$iot_api,"/user_eqp")).then(function(e){t.mqtt_start(e)}).catch(function(t){console.log(t)})},mqtt_start:function(){var t=new c["a"]({hostname:"wss://13xt3d9.mqtt.iot.gz.baidubce.com:443/mqtt",options:{username:"13xt3d9/gh_0ddfb722a565_c9edd422aafdc95f",password:"xY9Y6MQUYdCvrnJK",clientId:"gh_0ddfb722a565_c9edd422aafdc95f"},topic:{sub:"$baidu/iot/shadow/gh_0ddfb722a565_c9edd422aafdc95f/update/snapshot",pub:"$baidu/iot/shadow/gh_0ddfb722a565_c9edd422aafdc95f/update"},arrived:function(t){window.eventBus.$emit("baidu_shadow",t)},error:function(t){console.log(t)}});s["default"].prototype.$mqtt=t,this.$mqtt.startSub(),this.$mqtt.Client.subscribe("$baidu/iot/shadow/gh_0ddfb722a565_c9edd422aafdc95f/get/accepted"),this.$mqtt.Client.publish("$baidu/iot/shadow/gh_0ddfb722a565_c9edd422aafdc95f/get",JSON.stringify({residired:{},reported:{}}))}},destroyed:function(){this.$mqtt.closeSub()}},d=u,l=(i("7c55"),i("2877")),p=Object(l["a"])(d,o,r,!1,null,null,null);p.options.__file="App.vue";var h=p.exports,f=i("8c4f"),m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page"},[i("div",{staticClass:"page_top"},[i("h4",[t._v("欢迎使用！")]),i("span",[i("i",{staticClass:"iconfont icon-dizhi"}),t._v(t._s(t.weather.province)+"   "+t._s(t.weather.city))])]),i("div",{staticClass:"weather"},[i("div",{staticClass:"weather_temp"},[i("b",[t._v(t._s(t.weather.temp))]),i("span",[t._v("℃")])]),i("div",{staticClass:"weather_info"},[i("p",{staticClass:"weather_info_main"},[i("span",{attrs:{id:"weather_min"}},[t._v(t._s(t.weather.weather))])]),i("p",{staticClass:"weather_info_list"},[i("span",[t._v("温度：50 ℃")]),i("span",[t._v("湿度："+t._s(t.weather.humidity)+" RH")]),i("span",[t._v("风力："+t._s(t.weather.winddirection)+"风 "+t._s(t.weather.windpower)+"级")])])])]),i("div",{staticClass:"eqp_info"},[i("div",{staticClass:"eqp_info_main"},[t._v("26 PM2.5 重度污染")]),i("ul",{staticClass:"eqp_info_list"},[i("li",[i("span",[t._v("设定湿度")]),i("b",[t._v(t._s(t.eqp.humiditySet)+" RH")])]),i("li",[i("span",[t._v("当前湿度")]),i("b",[t._v(t._s(t.eqp.humidity)+" RH")])]),i("li",[i("span",[t._v("当前温度")]),i("b",[t._v(t._s(t.eqp.temperature1)+" ℃")])]),i("li",[i("span",[t._v("盘管温度")]),i("b",[t._v(t._s(t.eqp.temperature2)+" ℃")])])])]),i("div",{staticClass:"page_title"},[t._v("滤网设置")]),i("div",{staticClass:"residue_date"},[i("span",[t._v("剩余（小时）")]),i("b",[t._v(t._s(t.eqp.airFilter)+" H")])]),i("div",{staticClass:"page_title"},[t._v("主页设置")]),i("ul",{staticClass:"grid"},[i("li",{class:t.eqp.status?"":"off",on:{click:function(e){t.eqp_status(t.eqp.status)}}},[i("i",{staticClass:"grid_icon iconfont icon-kaiguan"}),i("span",{staticClass:"grid_text"},[t._v(t._s(1==t.eqp.status?"开":"关"))])]),i("li",{class:t.eqp.status?"":"forbiden",on:{click:function(e){t.eqp_fanSpeed(t.eqp.fanSpeed)}}},[1==t.eqp.fanSpeed?[i("i",{staticClass:"grid_icon iconfont icon-yijifeng"}),i("span",{staticClass:"grid_text"},[t._v("风速低")])]:2==t.eqp.fanSpeed||4==t.eqp.fanSpeed?[i("i",{staticClass:"grid_icon iconfont icon-erjifeng"}),i("span",{staticClass:"grid_text"},[t._v("风速中")])]:3==t.eqp.fanSpeed?[i("i",{staticClass:"grid_icon iconfont icon-sanjifeng"}),i("span",{staticClass:"grid_text"},[t._v("风速高")])]:t._e()],2),i("li",{class:t.eqp.status?"":"forbiden",on:{click:function(e){t.eqp_fanSpeed_auto(t.eqp.fanSpeed_auto)}}},[t.eqp.fanSpeed_auto?[i("i",{staticClass:"grid_icon iconfont icon-A"}),i("span",{staticClass:"grid_text"},[t._v("自动")])]:[i("i",{staticClass:"grid_icon iconfont icon-M"}),i("span",{staticClass:"grid_text"},[t._v("手动")])]],2),i("router-link",{class:t.eqp.status?"":"forbiden",attrs:{tag:"li",to:"/setting/eqpshare"}},[i("i",{staticClass:"grid_icon iconfont icon-fenxiang"}),i("span",{staticClass:"grid_text"},[t._v("共享")])]),i("li",{class:t.eqp.status?"":"forbiden",on:{click:t.show_popup}},[i("i",{staticClass:"grid_icon iconfont icon-neichushi"}),i("span",{staticClass:"grid_text"},[t._v("内除湿")])]),i("router-link",{attrs:{tag:"li",to:"/setting"}},[i("i",{staticClass:"grid_icon iconfont icon-shezhi"}),i("span",{staticClass:"grid_text"},[t._v("设置")])])],1),i("mt-popup",{staticClass:"popup_humidity not_select",attrs:{position:"bottom","close-on-click-modal":!1},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[i("div",{staticClass:"toolbar"},[i("span",{staticClass:"toobar_cancle",on:{click:t.humiditySet_cancle}},[t._v("取消")]),i("span",{staticClass:"toobar_confirm",on:{click:t.humiditySet_confirm}},[t._v("确定")])]),i("div",{staticClass:"humidity_number"},[t._v("设置湿度："),i("span",[t._v(t._s(t.eqp.humiditySet_last))])]),i("mt-range",{attrs:{min:0,max:100,step:1,"bar-height":5},model:{value:t.eqp.humiditySet_last,callback:function(e){t.$set(t.eqp,"humiditySet_last",e)},expression:"eqp.humiditySet_last"}},[i("div",{staticClass:"hunidity_range",attrs:{slot:"start"},slot:"start"},[t._v("0")]),i("div",{staticClass:"hunidity_range",attrs:{slot:"end"},slot:"end"},[t._v("100")])])],1)],1)},_=[],v={name:"home",data:function(){return{home_show:0,Mqtt:null,eqp:{status:0,fanSpeed_auto:!1,fanSpeed_last:1,fanSpeed:1,humiditySet_last:0,humiditySet:80,humidity:80,airFilter:60,temperature1:18,temperature2:0,errorCode:0,slaveNo:null},showPopup:!1,weather:{province:"上海",city:"上海市",weather:"晴",temp:0,humidity:0,winddirection:"",windpower:5}}},created:function(){this.$mqtt&&this.$mqtt.Client.publish("$baidu/iot/shadow/gh_0ddfb722a565_c9edd422aafdc95f/get",JSON.stringify({residired:{},reported:{}}));var t=this;window.eventBus.$on("baidu_shadow",function(e){console.log(e);var i=e.message.reported;t.compute_arrrived_data(i)}),this.get_city()},mounted:function(){},methods:{compute_arrrived_data:function(t){if("status"in t&&0<=t.status<=1&&(this.eqp.status=t.status),"fanSpeed"in t&&1<=t.fanSpeed<=4&&(this.eqp.fanSpeed=t.fanSpeed,this.eqp.fanSpeed_auto=4==t.fanSpeed),"humiditySet"in t&&0<=t.humiditySet<=100&&(this.eqp.humiditySet=t.humiditySet,this.eqp.humiditySet_last=t.humiditySet),"humidity"in t&&(this.eqp.humidity=t.humidity),"airFilter"in t&&(this.eqp.airFilter=t.airFilter),"temperature1"in t&&(this.eqp.temperature1=t.temperature1),"temperature2"in t&&(this.eqp.temperature2=t.temperature2),"errorCode"in t){var e=t.errorCode;if(this.eqp.errorCode=e,0==e)return!1;var i="";switch(e){case 1:i="盘管温度传感器故障（E1）";break;case 2:i="湿度传感器故障（E2）";break;case 3:i="排水保护故障（E0）";break;case 4:i="低压报警（E4）";break;case 5:i="高温报警，环境温度 > 41 &#8451;（E8）";break;default:i="未知故障（"+e+"）";break}this.$toast({message:i,duration:1500})}"slaveNo"in t&&(this.eqp.slaveNo=t.slaveNo)},publish:function(t,e){if(0==this.eqp.status&&!("status"in e))return this.$toast({message:"设备已关机",duration:1e3}),!1;this.$mqtt.publish({desired:e}),this.$toast({message:t,duration:1e3})},eqp_status:function(t){t=1==t?0:1;var e=1==t?"开机":"关机";this.publish(e,{status:t})},eqp_fanSpeed:function(t){var e="自动模式无法控制风速";4!=t&&(t=++t>3?1:t,e="风速 "+t,this.publish(e,{fanSpeed:t})),this.$toast({message:e,duration:1e3})},eqp_fanSpeed_auto:function(t){t?t=this.eqp.fanSpeed_last:(this.eqp.fanSpeed_last=this.eqp.fanSpeed,t=4);var e=4==t?"自动":"手动";this.publish(e,{fanSpeed:t})},eqp_newWindow:function(){},show_popup:function(){this.eqp.humiditySet_last=this.eqp.humiditySet,this.showPopup=!0},humiditySet_cancle:function(){this.showPopup=!1,this.eqp.humiditySet_last=this.eqp.humiditySet},humiditySet_confirm:function(){var t=this.eqp.humiditySet_last;this.showPopup=!1;var e="设定湿度 "+t+" RH";this.publish(e,{humiditySet:t})},get_city:function(){var t=this;this.$http.get("https://restapi.amap.com/v3/ip?&key=ff4317d533ad3d2b74756c4eb7643668").then(function(e){t.get_weather(e.data)}).catch(function(t){console.log(t)})},get_weather:function(t){var e=this;this.$http.post("https://restapi.amap.com/v3/weather/weatherInfo?&key=ff4317d533ad3d2b74756c4eb7643668",{city:t.adcode,extensions:"base"}).then(function(t){var i=t.data.lives[0];e.weather.province=i.province,e.weather.city=i.city,e.weather.weather=i.weather,e.weather.temp=i.temperature,e.weather.humidity=i.humidity,e.weather.winddirection=i.winddirection,e.weather.windpower=i.windpower}).catch(function(t){console.log(t)})}},destroyed:function(){window.eventBus.$off("baidu_shadow")}},b=v,g=(i("70d8"),Object(l["a"])(b,m,_,!1,null,"0261acf0",null));g.options.__file="Home.vue";var w=g.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page"},[i("div",{staticClass:"cell_list"},[t._l(t.arr1,function(t,e){return[i("mt-cell",{key:e,staticClass:"cell_item",attrs:{to:t.to,title:t.title,"is-link":""}},[i("i",{class:"iconfont "+t.icon,attrs:{slot:"icon"},slot:"icon"})])]})],2),i("div",{staticClass:"cell_list"},[t._l(t.arr2,function(t,e){return[i("mt-cell",{key:e,staticClass:"cell_item",attrs:{to:t.to,title:t.title,"is-link":""}},[i("i",{class:"iconfont "+t.icon,attrs:{slot:"icon"},slot:"icon"})])]})],2),i("div",{staticClass:"cell_list"},[t._l(t.arr3,function(t,e){return[i("mt-cell",{key:e,staticClass:"cell_item",attrs:{title:t.title,"is-link":""}},[i("i",{class:"iconfont "+t.icon,attrs:{slot:"icon"},slot:"icon"})])]})],2),i("transition",{attrs:{name:"slide",duration:{enter:300,leave:300}}},[i("router-view")],1)],1)},q=[],C={name:"seting",data:function(){return{arr1:[{icon:"icon-dizhi",title:"定时开关机",to:"/setting/timingswitch"},{icon:"icon-dizhi",title:"更换滤网",to:"/setting/airfilter"}],arr2:[{icon:"icon-dizhi",title:"设备共享",to:"/setting/eqpshare"},{icon:"icon-dizhi",title:"好友权限管理"},{icon:"icon-dizhi",title:"配置网络"},{icon:"icon-dizhi",title:"修改设备名称"},{icon:"icon-dizhi",title:"历史数据"}],arr3:[{icon:"icon-dizhi",title:"固件升级"},{icon:"icon-dizhi",title:"关于设备"}]}},created:function(){},methods:{}},S=C,k=(i("7794"),Object(l["a"])(S,y,q,!1,null,"f383e6ae",null));k.options.__file="Setting.vue";var x=k.exports;s["default"].use(f["a"]);var P=new f["a"]({base:"/iotweb/",routes:[{path:"/",component:w},{path:"/setting",component:x,children:[{path:"timingswitch",component:function(){return i.e("chunk-85141b9a").then(i.bind(null,"cb49"))}},{path:"airfilter",component:function(){return i.e("chunk-63c51285").then(i.bind(null,"291d"))}},{path:"eqpshare",component:function(){return i.e("chunk-35ef0f98").then(i.bind(null,"f4c3"))}}]},{path:"/device",component:function(){return i.e("chunk-4d67f7f8").then(i.bind(null,"f1b3"))}}]}),$=i("2f62");s["default"].use($["a"]);var E=new $["a"].Store({state:{mqtt_options:{}},mutations:{},actions:{}}),j=i("bc3a"),O=i.n(j),z=i("a7fe"),M=i.n(z),N=i("4328"),T=i.n(N),I=O.a.create({transformRequest:[function(t){return t=T.a.stringify(t),t}],headers:{"Content-Type":"application/x-www-form-urlencoded"}});s["default"].prototype.$iot_api="/iot_api",s["default"].use(M.a,I),s["default"].use(a.a),window.eventBus=new s["default"],s["default"].config.productionTip=!1,new s["default"]({router:P,store:E,render:function(t){return t(h)}}).$mount("#app")},"5c48":function(t,e,i){},"70d8":function(t,e,i){"use strict";var n=i("3aff"),a=i.n(n);a.a},7794:function(t,e,i){"use strict";var n=i("be85"),a=i.n(n);a.a},"7c55":function(t,e,i){"use strict";var n=i("5c48"),a=i.n(n);a.a},be85:function(t,e,i){}});
//# sourceMappingURL=app.905b7e51.js.map